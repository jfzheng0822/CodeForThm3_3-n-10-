k=0;
l=0;
B=[];
%Get matrixs that satisfies the lemma3.3 and n(G)>9, stored in B.
for a1_6=0:1
    for a1_7=0:1
        for a1_9=0:1
            for a2_8=0:1
                for a2_10=0:1
                    for a3_11=0:1
                        for a4_12=0:1
                            for a5_13=0:1
                                for a5_14=0:1
                                    for a6_8=0:1
                                        for a6_10=0:1
                                            for a6_12=0:1
                                                for a6_15=0:1
                                                    for a6_16=0:1
                                                        for a7_8=0:1
                                                            for a7_10=0:1
                                                                for a7_12=0:1
                                                                    for a7_15=0:1
                                                                        for a7_16=0:1
                                                                            for a8_11=0:1
                                                                                for a8_13=0:1
                                                                                    for a8_14=0:1
                                                                                        for a9_12=0:1
                                                                                            for a9_15=0:1
                                                                                                for a9_16=0:1
                                                                                                    for a10_13=0:1
                                                                                                        for a10_14=0:1
                                                                                                            for a11_15=0:1
                                                                                                                for a11_16=0:1
                                                                                                                    for a12_13=0:1
                                                                                                                        for a12_14=0:1
                                                                                                                            for a13_15=0:1
                                                                                                                                for a13_16=0:1
                                                                                                                                    for a14_15=0:1
                                                                                                                                        for a14_16=0:1
                                                                                                                                            l=l+1;
                                                                                                                                            if (a6_8<=a1_6) && (a6_10<=a1_6) && (a6_12<=a1_6) &&(a6_15<=a1_6) && (a6_16<=a1_6) && (a7_8<=a1_7)&& (a7_10<=a1_7) && (a7_12<=a1_7) &&(a7_15<=a1_7) && (a7_16<=a1_7) && (a8_11<=a2_8)  && (a8_13<=a2_8) && (a8_14<=a2_8)  && (a9_12<=a1_9) && (a9_15<=a1_9)&& (a9_16<=a1_9) && (a10_13<=a2_10) && (a10_14<=a2_10) && (a11_15<=a3_11) && (a11_16<=a3_11)  && (a12_13<=a4_12) && (a12_14<=a4_12) && (a13_15<=a5_13) && (a13_16<=a5_13) && (a14_15<=a5_14) && (a14_16<=a5_14) && (a6_8<=a2_8) && (a7_8<=a2_8) && (a6_10<=a2_10) && (a7_10<=a2_10) && (a8_11<=a3_11) && (a6_12<=a4_12) && (a7_12<=a4_12) && (a9_12<=a4_12) && (a8_13<=a5_13) && (a10_13<=a5_13) && (a12_13<=a5_13) && (a8_14<=a5_14) && (a10_14<=a5_14) && (a12_14<=a5_14) && (a6_8+a7_8<2) && (a6_10+a7_10<2) && (a6_12+a7_12+a9_12<3) && (a8_13+a10_13+a12_13<3) && (a8_14+a10_14+a12_14<3) && (a6_15+a7_15+a9_15+a11_15+a13_15+a14_15<5) && (a6_16+a7_16+a9_16+a11_16+a13_16+a14_16<5) && (a6_8+a6_10+a6_12+a6_15+a6_16<5) && (a7_8+a7_10+a7_12+a7_15+a7_16<5) && (a8_11+a8_13+a8_14<3)  && (a9_12+a9_15+a9_16<3)  && (a10_13+a10_14<2) && (a12_13+a12_14<2) && (a11_15+a11_16<2)
                                                                                                                                                A=zeros(16,16);
                                                                                                                                                A(1,2)=1;
                                                                                                                                                A(2,3)=1;
                                                                                                                                                A(3,4)=1;
                                                                                                                                                A(4,5)=1;
                                                                                                                                                A(1,6)=a1_6;
                                                                                                                                                A(1,7)=a1_7;
                                                                                                                                                A(1,9)=a1_9;
                                                                                                                                                A(3,9)=a1_9;
                                                                                                                                                A(2,8)=a2_8;
                                                                                                                                                A(2,10)=a2_10;
                                                                                                                                                A(4,10)=a2_10;
                                                                                                                                                A(3,11)=a3_11;
                                                                                                                                                A(5,11)=a3_11;
                                                                                                                                                A(4,12)=a4_12;
                                                                                                                                                A(5,13)=a5_13;
                                                                                                                                                A(5,14)=a5_14;
                                                                                                                                                A(6,8)=a6_8;
                                                                                                                                                A(6,10)=a6_10;
                                                                                                                                                A(6,12)=a6_12;
                                                                                                                                                A(6,15)=a6_15;
                                                                                                                                                A(6,16)=a6_16;
                                                                                                                                                A(7,8)=a7_8;
                                                                                                                                                A(7,10)=a7_10;
                                                                                                                                                A(7,12)=a7_12;
                                                                                                                                                A(7,15)=a7_15;
                                                                                                                                                A(7,16)=a7_16;
                                                                                                                                                A(8,11)=a8_11;
                                                                                                                                                A(8,13)=a8_13;
                                                                                                                                                A(8,14)=a8_14;
                                                                                                                                                A(9,12)=a9_12;
                                                                                                                                                A(9,15)=a9_15;
                                                                                                                                                A(9,16)=a9_16;
                                                                                                                                                A(10,13)=a10_13;
                                                                                                                                                A(10,14)=a10_14;
                                                                                                                                                A(11,15)=a11_15;
                                                                                                                                                A(11,16)=a11_16;
                                                                                                                                                A(12,13)=a12_13;
                                                                                                                                                A(12,14)=a12_14;
                                                                                                                                                A(13,15)=a13_15;
                                                                                                                                                A(13,16)=a13_16;
                                                                                                                                                A(14,15)=a14_15;
                                                                                                                                                A(14,16)=a14_16;
                                                                                                                                                A=A+A';
                                                                                                                                                if sx2(A)==1
                                                                                                                                                    k=k+1;
                                                                                                                                                    B(:,:,k)=A;
                                                                                                                                                end
                                                                                                                                            end
                                                                                                                                        end
                                                                                                                                    end
                                                                                                                                end
                                                                                                                            end
                                                                                                                        end
                                                                                                                    end
                                                                                                                end
                                                                                                            end
                                                                                                        end
                                                                                                    end
                                                                                                end
                                                                                            end
                                                                                        end
                                                                                    end
                                                                                end
                                                                            end
                                                                        end
                                                                    end
                                                                end
                                                            end
                                                        end
                                                    end
                                                end
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

%Only one of the isomorphic graph is retaind, and the rest are 0 matrices.
C=B;
[x y z]=size(C);
for h=1:z-1
    BB1=sx1(C(:,:,h));
    ss1=length(BB1);
    G1=graph(BB1);
    for m=h+1:z
        BB2=sx1(C(:,:,m));
        ss2=length(BB2);
        G2=graph(BB2);
        if (ss1==ss2) && (isisomorphic(G1,G2)==1)
            C(:,:,m)=zeros(16,16);
        end
    end
end

%remove 0 matrices in C.
[x y z]=size(C);
D=[];
w=0;
for i=1:z
    if sum(sum(C(:,:,i)))>0
        w=w+1;
        D(:,:,w)=C(:,:,i);
    end
end

[x y z]=size(D);
for i=1:z
figure(i);
plot(graph(sx1(D(:,:,i))));
end